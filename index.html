
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript--nodejs&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">curl</a>
              <a href="#" data-language-name="javascript--nodejs">Node</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#endpoints" class="toc-h1 toc-link" data-title="Endpoints">Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#retrieve-a-list-of-flights" class="toc-h2 toc-link" data-title="Retrieve a list of flights">Retrieve a list of flights</a>
                  </li>
                  <li>
                    <a href="#create-a-request" class="toc-h2 toc-link" data-title="Create a request">Create a request</a>
                  </li>
                  <li>
                    <a href="#confirm-a-request-and-create-a-booking" class="toc-h2 toc-link" data-title="Confirm a request and create a booking">Confirm a request and create a booking</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#testing" class="toc-h1 toc-link" data-title="Testing">Testing</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href="mailto:tech@citizenplane.com" target="_blank">Contact CitizenPlane</a></li>
            <li>CitizenPlane 2017-2018</li>
            <li>All rights reserved</li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p><a href="https://citizenplane.com/" target="_blank">CitizenPlane</a> is a software company that connects travel agencies and metasearches to air content providers. Our REST API allows ETAs to search within our stock of open flights, create bookings and process payments.</p>

<p>The default API endpoint is <a href="https://booking-api.citizenplane.com" target="_blank"> booking-api.citizenplane.com</a>. JSON is returned by all API responses, including errors.</p>

<p>To make the API as explorable as possible, accounts have test and live API tokens. To get your token, contact us at <a href="mailto:tech@citizenplane.com" target="_blank">tech@citizenplane.com</a>.</p>

<p>If you wish to test the different endpoints detailed below, we have a dedicated page allowing you to perform requests with your parameters. An API token will be required for each call. To test our endpoints, <a href="https://booking-api.citizenplane.com/documentation" target="_blank">click here</a>.</p>

<aside class ="notice">Current API version is 1.1. Therefore, every endpoint has /v1 appended to its url.</aside>
<h1 id='authentication'>Authentication</h1><pre class="highlight shell tab-shell"><code><span class="c"># Example request</span>

curl <span class="s2">"https://booking-api.citizenplane.com/v1/flights"</span> <span class="se">\</span>
   -H <span class="s2">"Authorization: Bearer {your_api_token}"</span>

<span class="c"># Make sure to replace {your_api_token} with the token you were given.</span>
</code></pre>
<p>Authentication to the API is performed via <strong>Bearer Tokens</strong>. Tokens are unique and non-expirable. Make sure not to share your token in publicly accessible area such GitHub or client-side code.</p>

<p>Every request to CitizenPlane API must include a Bearer token in the following format: <code>Authorization: Bearer {your_api_token}</code></p>
<h1 id='endpoints'>Endpoints</h1><h2 id='retrieve-a-list-of-flights'>Retrieve a list of flights</h2>
<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://booking-api.citizenplane.com/v1/flights"</span>
  -H <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer {your_api_token}"</span>
</code></pre><pre class="highlight javascript tab-javascript--nodejs"><code><span class="kr">const</span> <span class="nx">rp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"request-promise"</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">getFlights</span> <span class="o">=</span> <span class="nx">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">flights</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">rp</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
      <span class="na">uri</span><span class="p">:</span> <span class="s2">"https://booking-api.citizenplane.com/v1/flights"</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="s2">"Bearer {your_api_token}"</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="nx">flights</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
 <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20222</span><span class="p">,</span><span class="w">
      </span><span class="s2">"organization_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Demo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"flight_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5O7892"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CDG"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PMI"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"online_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">273</span><span class="p">,</span><span class="w">
      </span><span class="s2">"luggage"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"available_seats"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"airline"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CitizenPlane"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"operated_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transavia"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"cabin_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"economy"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"booking_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"online_infant_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w">
      </span><span class="s2">"included_airport_tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w">
      </span><span class="s2">"departure_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-29 10:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"arrival_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-29 16:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"nbResults"</span><span class="p">:</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w">
  </span><span class="s2">"page"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"nbPages"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves a list of flights in CitizenPlane&#39;s stock. Flights returned by the API are identified by a unique ID that will be needed for the <code>/requests</code> endpoint.</p>
<h3 id='http-request'>HTTP request</h3>
<p><code>GET https://booking-api.citizenplane.com/v1/flights</code></p>

<aside class="success">To test this endpoint, <a href="https://booking-api.citizenplane.com/documentation#/flights" target="_blank">click here</a>.</aside>
<h3 id='url-parameters'>URL parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>origin</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>A string of uppercase, comma-separated iata codes containing a list of departure airports (up to a maximum of 10 airports).</td>
</tr>
<tr>
<td>nearbyO</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>If set to <code>true</code>, nearby departure airports (up to 100km) will be considered in the flight search. Defaults to <code>false</code>.</td>
</tr>
<tr>
<td>destination</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>A string of uppercase, comma-separated iata codes containing a list of arrival airports (up to a maximum of 10 airports).</td>
</tr>
<tr>
<td>nearbyD</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>If set to <code>true</code>, nearby arrival airports (up to 100km) will be considered in the flight search. Defaults to <code>false</code>.</td>
</tr>
<tr>
<td>start</td>
<td><em>date</em></td>
<td><em>optional</em></td>
<td>Date from which the flight search will be operated. Date has to be formatted following this model: <code>YYYY-MM-DD</code>.</td>
</tr>
<tr>
<td>end</td>
<td><em>date</em></td>
<td><em>optional</em></td>
<td>Date until which the flight search will be operated. Date has to be formatted following this model: <code>YYYY-MM-DD</code>.</td>
</tr>
<tr>
<td>seats</td>
<td><em>integer</em></td>
<td><em>optional</em></td>
<td>Maximum number of seats to search for.</td>
</tr>
<tr>
<td>page</td>
<td><em>integer</em></td>
<td><em>optional</em></td>
<td>Specify the page to retrieve. Each page displays up to 100 results. Defaults to 0 (page numbers are zero-based).</td>
</tr>
</tbody></table>
<h2 id='create-a-request'>Create a request</h2>
<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST --header <span class="s1">'Content-Type: application/json'</span> --header <span class="s1">'Accept: application/json'</span> --header <span class="s1">'authorization: {your_api_token}'</span> -d <span class="s1">'{
  "flight_id": 20222,
    "passengers": {
        "adults": 2,
        "children": 0,
        "infants": 0
    }
}'</span> <span class="s1">'https://booking-api.citizenplane.com/v1/requests'</span>
</code></pre><pre class="highlight javascript tab-javascript--nodejs"><code><span class="kr">const</span> <span class="nx">rp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"request-promise"</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">createRequest</span> <span class="o">=</span> <span class="nx">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">rp</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
      <span class="na">uri</span><span class="p">:</span> <span class="s2">"https://booking-api.citizenplane.com/v1/requests"</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="s2">"Bearer {your_api_token}"</span>
      <span class="p">},</span>
      <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">body</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flight_id</span><span class="p">:</span> <span class="mi">20222</span><span class="p">,</span>
    <span class="na">passengers</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">adults</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">children</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">infants</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="nx">request</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
    </span><span class="s2">"seats"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"effective_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">273</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-16T15:02:28.797Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"flight"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20222</span><span class="p">,</span><span class="w">
        </span><span class="s2">"formatted_date"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"departure"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"November 29th 2018"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"arrival"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"November 29th 2018"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16:00"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"luggage"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
        </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"iata_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CDG"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"iata_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PMI"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"online_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">273</span><span class="p">,</span><span class="w">
        </span><span class="s2">"online_infant_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w">
        </span><span class="s2">"airline"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CitizenPlane"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"operated_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transavia"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a booking request on a flight (identified by its id). A booking request holds the number of seats set in the request payload for <strong>fifteen minutes</strong>. Seat and infant prices won&#39;t be subject to any changes during this time period.</p>

<aside class ="notice">Should the booking not be confirmed, the request would be canceled and the seats put back in sales.</aside>
<h3 id='http-request-2'>HTTP request</h3>
<p><code>POST https://booking-api.citizenplane.com/v1/requests</code></p>

<aside class="success">To test this endpoint, <a href="https://booking-api.citizenplane.com/documentation#/requests" target="_blank">click here</a>.</aside>
<h3 id='url-parameters-2'>URL parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>flight_id</td>
<td><em>integer</em></td>
<td><strong>required</strong></td>
<td>The flight id (see <code>/flights</code>).</td>
</tr>
<tr>
<td>passengers</td>
<td><em>object</em></td>
<td><strong>required</strong></td>
<td>An object containing the passenger count breakdown by age for this booking request. <a href="#request-passengers-info">See child arguments</a>.</td>
</tr>
</tbody></table>

<p><br/>
<br/></p>
<h4 id='5f77584915'><table id="request-passengers-info"></h4>
<p><caption> Passengers child arguments</caption>
  <tbody>
    <tr>
      <th align="left">Parameter</th>
      <th align="left">Type</th>
      <th align="left">Status</th>
      <th align="left">Description</th>
    </tr>
    <tr>
      <td align="left">adults</td>
      <td align="left"><i>integer</i></td>
      <td align="left"><em>optional</em></td>
      <td align="left">Number of adults to book on this flight.</td>
    </tr>
    <tr>
      <td align="left">children</td>
      <td align="left"><i>integer</i></td>
      <td align="left"><em>optional</em></td>
      <td align="left">Number of children to book on this flight.</td>
    </tr>
    <tr>
      <td align="left">infants</td>
      <td align="left"><i>integer</i></td>
      <td align="left"><em>optional</em></td>
      <td align="left">Number of infants (2 &lt; yo) to book on this flight. Cannot be higher than the sum of adults and children passengers.</td>
    </tr>
  </tbody>
</table></p>
<h2 id='confirm-a-request-and-create-a-booking'>Confirm a request and create a booking</h2>
<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl POST --header <span class="s1">'Content-Type: application/json'</span> --header <span class="s1">'Accept: application/json'</span> --header <span class="s1">'authorization: {your_api_token}'</span> -d <span class="s1">'{
  "request_id": 19,
  "booking_id": "12345",
  "first_name": "John",
  "last_name": "Doe",
  "gender": "male",
  "email": "john.doe@example.com",
  "phonenumber": "+33600000000",
  "passenger_count": 2,
  "infant_count": 0,
  "passengers": [
    {
      "first_name": "John",
      "last_name": "Doe",
      "gender": "male",
      "is_infant": false
    },
    {
      "first_name": "Jane",
      "last_name": "Doe",
      "gender": "female",
      "is_infant": false
    }
  ],
  "card_data": {
    "number": "4242424242424242",
    "exp_year": 2019,
    "exp_month": 11,
    "cvc": "555",
    "name": "John Doe"
  }
}'</span> <span class="s1">'https://booking-api.citizenplane.com/v1/bookings'</span>
</code></pre><pre class="highlight javascript tab-javascript--nodejs"><code><span class="kr">const</span> <span class="nx">rp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"request-promise"</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">createBooking</span> <span class="o">=</span> <span class="nx">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">booking</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">rp</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
      <span class="na">uri</span><span class="p">:</span> <span class="s2">`https://booking-api.citizenplane.com/v1/bookings`</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="s2">"Bearer {your_api_token}"</span>
      <span class="p">},</span>
      <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">body</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"request_id"</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
        <span class="s2">"booking_id"</span><span class="p">:</span> <span class="s2">"12345"</span><span class="p">,</span>
    <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="s2">"last_name"</span><span class="p">:</span> <span class="s2">"Doe"</span><span class="p">,</span>
    <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span>
    <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"john.doe@example.com"</span><span class="p">,</span>
    <span class="s2">"phonenumber"</span><span class="p">:</span> <span class="s2">"+33600000000"</span><span class="p">,</span>
    <span class="s2">"passenger_count"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">"infant_count"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"passengers"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
        <span class="s2">"last_name"</span><span class="p">:</span> <span class="s2">"Doe"</span><span class="p">,</span>
        <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span>
        <span class="s2">"is_infant"</span><span class="p">:</span> <span class="kc">false</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"Jane"</span><span class="p">,</span>
        <span class="s2">"last_name"</span><span class="p">:</span> <span class="s2">"Doe"</span><span class="p">,</span>
        <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"female"</span><span class="p">,</span>
        <span class="s2">"is_infant"</span><span class="p">:</span> <span class="kc">false</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">"card_data"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"number"</span><span class="p">:</span> <span class="s2">"4242424242424242"</span><span class="p">,</span>
      <span class="s2">"exp_year"</span><span class="p">:</span> <span class="mi">2019</span><span class="p">,</span>
      <span class="s2">"exp_month"</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
      <span class="s2">"cvc"</span><span class="p">:</span> <span class="s2">"555"</span><span class="p">,</span>
      <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"John Doe"</span>
    <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="nx">booking</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"booking"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"flight_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20222</span><span class="p">,</span><span class="w">
    </span><span class="s2">"effective_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w">
    </span><span class="s2">"effective_infant_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pnr_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"K9IR6XLGQ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"male"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"passenger_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"infant_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"passengers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"male"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_infant"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_infant"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-16T15:02:42.441Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8765"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"flight"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20222</span><span class="p">,</span><span class="w">
     </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"iata_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CDG"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Paris"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"France"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Europe/Paris"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"iata_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PMI"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Palma de Majorque"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Espagne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Europe/Madrid"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="s2">"departure_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-29T09:00:00.000Z"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"arrival_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-29T15:00:00.000Z"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"organization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Orga-1"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="s2">"cabin_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"economy"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"booking_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"included_airport_tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
     </span><span class="s2">"airline"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CitizenPlane"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operated_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASL Airlines France"</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint confirms the previously created booking request and processes the booking as well as the associated payment. Once the booking is created, the customer will receive a confirmation by email along with the ticket(s).</p>

<aside class="notice">If the payment fails for any reason, the request associated to this booking will be considered as aborted and the process is to be started again.</aside>
<h3 id='http-request-3'>HTTP request</h3>
<p><code>POST https://booking-api.citizenplane.com/v1/bookings</code></p>

<aside class="success">To test this endpoint, <a href="https://booking-api.citizenplane.com/documentation#/bookings" target="_blank">click here</a>.</aside>
<h3 id='url-parameters-3'>URL parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>request_id</td>
<td><em>integer</em></td>
<td><strong>required</strong></td>
<td>The request id (see <code>/requests</code>).</td>
</tr>
<tr>
<td>booking_id</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>An id generated by the caller to identify the booking.</td>
</tr>
<tr>
<td>distribution_channel</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>Name of the ETA through which the reservation has been made.</td>
</tr>
<tr>
<td>first_name</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>The customer&#39;s first name.</td>
</tr>
<tr>
<td>last_name</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>The customer&#39;s last name.</td>
</tr>
<tr>
<td>gender</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>The customer&#39;s gender.</td>
</tr>
<tr>
<td>email</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>The customer&#39;s email.</td>
</tr>
<tr>
<td>phonenumber</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>The customer&#39;s phone number.</td>
</tr>
<tr>
<td>address</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>The customer&#39;s address.</td>
</tr>
<tr>
<td>city_name</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>The customer&#39;s city name.</td>
</tr>
<tr>
<td>country_code</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>The customer&#39;s country code.</td>
</tr>
<tr>
<td>postal_code</td>
<td><em>string</em></td>
<td><em>optional</em></td>
<td>The customer&#39;s postal code.</td>
</tr>
<tr>
<td>passenger_count</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>Total passengers on this booking (infants excluded).</td>
</tr>
<tr>
<td>infant_count</td>
<td><em>string</em></td>
<td><strong>required</strong></td>
<td>Total infants on this booking (&lt; 2yo).</td>
</tr>
<tr>
<td>passengers</td>
<td><em>object</em></td>
<td><strong>required</strong></td>
<td>An object containing personal information for each passenger on this booking. <a href="#booking-passengers-info">See child arguments</a>.</td>
</tr>
<tr>
<td>card_data</td>
<td><em>object</em></td>
<td><strong>required</strong></td>
<td>An object containing the customer&#39;s credit card information. <a href="#booking-card-info">See child arguments</a>.</td>
</tr>
</tbody></table>

<p><br/>
<br/></p>
<h4 id='9a1059b8fd'><table id="booking-passengers-info"></h4>
<p><caption><b>passengers child arguments</b></caption>
  <tbody>
    <tr>
      <th align="left">Parameter</th>
      <th align="left">Type</th>
      <th align="left">Status</th>
      <th align="left">Description</th>
    </tr>
    <tr>
      <td align="left">first_name</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">Passenger&#39;s first name.</td>
    </tr>
    <tr>
      <td align="left">last_name</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">Passenger&#39;s last name.</td>
    </tr>
    <tr>
      <td align="left">gender</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">Passenger&#39;s gender.</td>
    </tr>
    <tr>
      <td align="left">is_infant</td>
      <td align="left"><i>boolean</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">If the passenger is an infant (&lt; 2 yo), set is_infant to true.</td>
    </tr>
    <tr>
      <td align="left">birth_country</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s birth country.</td>
    </tr>
    <tr>
      <td align="left">date_of_birth</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s date of birth.</td>
    </tr>
    <tr>
      <td align="left">passport_number</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s passport number.</td>
    </tr>
    <tr>
      <td align="left">passport_expiry_date</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s passport expiry date.</td>
    </tr>
    <tr>
      <td align="left">passport_country_of_issue</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s passport country of issue.</td>
    </tr>
    <tr>
      <td align="left">nationality</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">Passenger&#39;s nationality.</td>
    </tr>
  </tbody>
</table></p>

<p><br/>
<br/></p>
<h4 id='49032490bf'><table id="booking-card-info"></h4>
<p><caption><b>card_data child arguments</b></caption>
  <tbody>
    <tr>
      <th align="left">Parameter</th>
      <th align="left">Type</th>
      <th align="left">Status</th>
      <th align="left">Description</th>
    </tr>
    <tr>
      <td align="left">number</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">The customer&#39;s card number.</td>
    </tr>
    <tr>
      <td align="left">exp_year</td>
      <td align="left"><i>integer</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">The customer&#39;s card expiration year (format <code>YYYY</code>).</td>
    </tr>
    <tr>
      <td align="left">exp_month</td>
      <td align="left"><i>integer</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">The customer&#39;s card expiration month (format <code>MM</code>).</td>
    </tr>
    <tr>
      <td align="left">cvc</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b>required</b></td>
      <td align="left">Card security code. Only required for accounts based in European countries but highly recommended for other countries.</td>
    </tr>
    <tr>
      <td align="left">name</td>
      <td align="left"><i>string</i></td>
      <td align="left"><b><em>optional</em></b></td>
      <td align="left">The cardholder&#39;s full name.</td>
    </tr>
  </tbody>
</table></p>
<h1 id='testing'>Testing</h1>
<p>CitizenPlane&#39;s API has a sandbox mode allowing you to safely test your integration with us. In order to do so, you will need a test token, which will give you access to our demo flights. You will be able to test our different endpoints without actually booking any seats or processing any payments.</p>

<aside class ="notice">Please note that we only have a few demo flights for you to use. We advise you to first make a GET request to /flights without any query parameters except pagination to get the full list of demo flights. You'll then know wich query parameters to test.</aside>

<p>To test the payment processing method, use any of the testing cards provided by Stripe: <a href="https://stripe.com/docs/testing#cards" target="_blank">Stripe testing cards</a>.</p>

<p>Once you&#39;re ready to go live, you&#39;ll receive a live token that will allow you to process bookings and payments through our API.</p>

<p>If you have any questions, feel free to reach us at <a href="mailto:tech@citizenplane.com">tech@citizenplane</a>.</p>
<h1 id='errors'>Errors</h1>
<aside class="notice">
CitizenPlane uses conventional HTTP response codes to indicate the success or failure of an API request. Codes in the 4xx range indicate an error that failed given the information provided (e.g., a required parameter was omitted, a request has expired, a charge failed, etc.). Codes in the 5xx range indicate an error with CitizenPlane's servers (these are rare).
</aside>

<p>The CitizenPlane API uses the following error codes:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid (e.g missing payload keys or process a booking with a <code>passenger_count</code> that doesn&#39;t match the data stored during the request call).</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The requested action cannot be permitted (e.g process a booking on a <code>ABORTED</code> request)</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified data could not be found (e.g <code>flight_id</code> doesn&#39;t exist)</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later and contact us if the issue remain.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">curl</a>
                <a href="#" data-language-name="javascript--nodejs">Node</a>
          </div>
      </div>
    </div>
  </body>
</html>
